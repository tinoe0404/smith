{% include 'imports.html' %}
{% include 'navbar.html' %}

<div style="margin-left: 50px;margin-top: 50px;">
    <h1 style="font-family: Merriweather, serif;font-weight: 600;">Shopping Cart</h1>
</div>



<table class="uk-table uk-table-divider uk-margin-large-left">
    <thead>
        <tr>
            <th>Image</th>
            <th>Item Name</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Total</th>
        </tr>
    </thead>
    <tbody id="cartItemsTableBody">
        <!-- Cart items will be dynamically inserted here -->
    </tbody>
</table>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        let cartItems = JSON.parse(localStorage.getItem('cartItems')) || [];
        let cartItemsTableBody = document.getElementById('cartItemsTableBody');

        cartItems.forEach(item => {
            let row = document.createElement('tr');

            let imgCell = document.createElement('td');
            let img = document.createElement('img');
            img.src = item.img;
            img.alt = item.name;
            img.style.width = '50px';
            img.style.height = '50px';
            imgCell.appendChild(img);

            let nameCell = document.createElement('td');
            nameCell.textContent = item.name;

            let quantityCell = document.createElement('td');
            let quantityInput = document.createElement('input');
            quantityInput.className = 'uk-input uk-form-width-small';
            quantityInput.type = 'number';
            quantityInput.min = '0';
            quantityInput.value = item.quantity || '1';
            quantityCell.appendChild(quantityInput);

            let priceCell = document.createElement('td');
            priceCell.textContent = `${item.price}`;

            let totalCell = document.createElement('td');
            item.price = parseFloat(item.price.replace("$", ""));
            totalCell.textContent = `${(item.price * quantityInput.value).toFixed(2)}`;

            quantityInput.addEventListener('input', function () {
                totalCell.textContent = `${(item.price * quantityInput.value).toFixed(2)}`;
            });

            row.appendChild(imgCell);
            row.appendChild(nameCell);
            row.appendChild(quantityCell);
            row.appendChild(priceCell);
            row.appendChild(totalCell);

            cartItemsTableBody.appendChild(row);
        });
    });
</script>
<div class="uk-margin uk-margin-large-left">
    <h3 style="font-family: Raleway, sans-serif;" id="subtotal">Subtotal: $0.00</h3>
    <button onclick="pushNotify();" class="uk-button uk-button-secondary uk-text-bold">Checkout</button>
</div>

<hr class="uk-divider-icon">
<div class="uk-text-center">

    <p style="font-weight: 600;">&copy; &nbsp; 2024 WatchHub </p>

</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        let subtotalElement = document.getElementById('subtotal');
        let cartItemsTableBody = document.getElementById('cartItemsTableBody');
        let subtotal = 0;

        cartItemsTableBody.querySelectorAll('tr').forEach(row => {
            let totalCell = row.querySelector('td:last-child');
            subtotal += parseFloat(totalCell.textContent);
        });

        subtotalElement.textContent = `Subtotal: $${subtotal.toFixed(2)}`;

        cartItemsTableBody.addEventListener('input', function () {
            subtotal = 0;
            cartItemsTableBody.querySelectorAll('tr').forEach(row => {
                let totalCell = row.querySelector('td:last-child');
                subtotal += parseFloat(totalCell.textContent);
            });
            subtotalElement.textContent = `Subtotal: $${subtotal.toFixed(2)}`;
        });
    });
</script>
</div>

<script>
    let storedCartCount = localStorage.getItem('cartCount');

    if (storedCartCount) {
        document.getElementById('cartCount').textContent = storedCartCount;
    }

    function pushNotify() {
        new Notify({
            status: 'success',
            title: 'Checkout',
            text: 'Order checkout successful',
            effect: 'fade',
            speed: 300,
            customClass: null,
            customIcon: null,
            showIcon: true,
            showCloseButton: true,
            autoclose: true,
            autotimeout: 2000,
            gap: 20,
            distance: 20,
            type: 'outline',
            position: 'x-center'
        })

        localStorage.clear();
        setTimeout(() => {
            window.location.href = '/';
        }, 2000);

    }
</script>
</div>
<div>
    <div style="display: flex;">
        <div class="uk-text-left uk-margin-large-left">
            <p style="font-weight: 700;">ABOUT US</p>
            <p style="font-weight: 600;">Your go-to source for expert <br>reviews, news, and insights<br> on fine
                timepieces.</p>
        </div>
        <div class="uk-text-center" style="margin-left: 410px;">
            <p style="font-weight: 600;">FOLLOW US</p>
            <div style="display: flex;">
                <P style="display: none;"><span uk-icon="facebook"></span></P>&nbsp;&nbsp;&nbsp;
                <a href="https://www.facebook.com/profile.php?id=100073225172594&mibextid=ZbWKwL"><span uk-icon="facebook"></span></P>&nbsp;&nbsp;&nbsp;
                <a href="https://x.com/Tinoe0404?t=NHeOdZeHwGG5Wq0m_dPYXg&s=09"><span uk-icon="x"></span></P> &nbsp;&nbsp;
                <a href="http://www.linkedin.com/in/tinotenda-chandengenda-9a1086306"><span uk-icon="linkedin"></span></a>
            </div>
        </div>

        <div class="uk-text-right" style="margin-left: 300px;">
            <p style="font-weight: 600;">Tinotenda Chandengenda</p>
            <p style="font-weight: 600;">H230279Z</p>
            <p style="font-weight: 600;">Harare Institute Of Technology</p>
        </div>

    </div>
<script>
    document.getElementById('SearchBar').addEventListener('input', function () {
        const query = this.value.toLowerCase();
        const items = document.querySelectorAll('.uk-card');

        items.forEach(item => {
            const text = item.textContent.toLowerCase();
            item.style.display = text.includes(query) ? '' : 'none';
        });
    });
</script>